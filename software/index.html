<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Реалізація інформаційного та програмного забезпечення | @molfar/msapi-parser</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="/msapi-parser/favicon.ico">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.5.1/katex.min.css">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <meta name="description" content="msapi-parser module documentation">
    
    <link rel="preload" href="/msapi-parser/assets/css/0.styles.64ca5c7f.css" as="style"><link rel="preload" href="/msapi-parser/assets/js/app.bded45cf.js" as="script"><link rel="preload" href="/msapi-parser/assets/js/2.79cb4c26.js" as="script"><link rel="preload" href="/msapi-parser/assets/js/21.261008f1.js" as="script"><link rel="prefetch" href="/msapi-parser/assets/js/10.ea326503.js"><link rel="prefetch" href="/msapi-parser/assets/js/11.19fb94d4.js"><link rel="prefetch" href="/msapi-parser/assets/js/12.1b81dedb.js"><link rel="prefetch" href="/msapi-parser/assets/js/13.c8698469.js"><link rel="prefetch" href="/msapi-parser/assets/js/14.c713c1e1.js"><link rel="prefetch" href="/msapi-parser/assets/js/15.89870f87.js"><link rel="prefetch" href="/msapi-parser/assets/js/16.538f20d4.js"><link rel="prefetch" href="/msapi-parser/assets/js/17.ee601123.js"><link rel="prefetch" href="/msapi-parser/assets/js/18.02c777aa.js"><link rel="prefetch" href="/msapi-parser/assets/js/19.60f06c77.js"><link rel="prefetch" href="/msapi-parser/assets/js/20.0985ba80.js"><link rel="prefetch" href="/msapi-parser/assets/js/22.f5c499b9.js"><link rel="prefetch" href="/msapi-parser/assets/js/23.2a634fc4.js"><link rel="prefetch" href="/msapi-parser/assets/js/24.acd4fb4f.js"><link rel="prefetch" href="/msapi-parser/assets/js/25.47d81a01.js"><link rel="prefetch" href="/msapi-parser/assets/js/26.4949bd87.js"><link rel="prefetch" href="/msapi-parser/assets/js/27.30313faf.js"><link rel="prefetch" href="/msapi-parser/assets/js/3.08437077.js"><link rel="prefetch" href="/msapi-parser/assets/js/4.8a9254ad.js"><link rel="prefetch" href="/msapi-parser/assets/js/5.aa6c9008.js"><link rel="prefetch" href="/msapi-parser/assets/js/6.864766ac.js"><link rel="prefetch" href="/msapi-parser/assets/js/7.6b4592f9.js"><link rel="prefetch" href="/msapi-parser/assets/js/8.f3f13380.js"><link rel="prefetch" href="/msapi-parser/assets/js/9.fd0892df.js">
    <link rel="stylesheet" href="/msapi-parser/assets/css/0.styles.64ca5c7f.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/msapi-parser/" class="home-link router-link-active"><!----> <span class="site-name">@molfar/msapi-parser</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/msapi-parser/" class="nav-link">
  Початок
</a></div> <a href="https://github.com/wdc-molfar/msapi-parser" target="_blank" rel="noopener noreferrer" class="repo-link">
    Github
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/msapi-parser/" class="nav-link">
  Початок
</a></div> <a href="https://github.com/wdc-molfar/msapi-parser" target="_blank" rel="noopener noreferrer" class="repo-link">
    Github
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><a href="/msapi-parser/intro/" class="sidebar-link">Вступ</a></li><li><a href="/msapi-parser/requirements/" class="sidebar-link">Вимоги</a></li><li><a href="/msapi-parser/software/" aria-current="page" class="active sidebar-link">Реалізація</a></li><li><a href="/msapi-parser/api/" class="sidebar-link">API</a></li><li><a href="/msapi-parser/test/" class="sidebar-link">Тестування</a></li><li><a href="/msapi-parser/conclusion/" class="sidebar-link">Висновки</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="реалізація-інформаціиного-та-програмного-забезпечення"><a href="#реалізація-інформаціиного-та-програмного-забезпечення" class="header-anchor">#</a> Реалізація інформаційного та програмного забезпечення</h1> <h2 id="приклад-використання-msapi-специфікаціи"><a href="#приклад-використання-msapi-специфікаціи" class="header-anchor">#</a> Приклад використання MSAPI-специфікацій</h2> <p>В прикладі визначається робочий процес з двох екземплярів сервісів. Перший - завантажує повідомлення з джерел на основі завдань, що
вибирає з черги завдань. Другий - виконує нормалізацію повідомлень.</p> <p>В окремих файлах визначаються глобальні налаштування, налаштування за замовченням, типи черг та обмінників, типи мікросервісів та
робочий процес.</p> <p><strong>Файл глобальних налаштувань</strong> містить налаштування для брокера повідомлень та налаштування підсистеми виявлення та моніторингу працездатності мікросервісів</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code>
<span class="token key atrule">msapi</span><span class="token punctuation">:</span> <span class="token string">&quot;1.0.1&quot;</span>

<span class="token key atrule">metadata</span><span class="token punctuation">:</span> 
  
  <span class="token key atrule">id</span><span class="token punctuation">:</span> <span class="token string">&quot;http://localhost:8081/spec/ms_example_global_settings.yaml&quot;</span>
  
  <span class="token key atrule">title</span><span class="token punctuation">:</span> <span class="token string">&quot;Global settings&quot;</span>
  
  <span class="token key atrule">description</span><span class="token punctuation">:</span> Default queue and exchange settings
  
 
<span class="token key atrule">components</span><span class="token punctuation">:</span>

<span class="token comment">#########################################################################</span>

    <span class="token key atrule">Settings</span><span class="token punctuation">:</span>                          <span class="token comment"># available section</span>
        
        <span class="token key atrule">amqp</span><span class="token punctuation">:</span>
            <span class="token key atrule">url</span><span class="token punctuation">:</span> <span class="token string">&quot;amqps://xoilebqg:Nx46t4t9cxQ2M0rF2rIyZPS_xbAhmJIG@hornet.rmq.cloudamqp.com/xoilebqg&quot;</span>
        

        <span class="token key atrule">health</span><span class="token punctuation">:</span>                       
            <span class="token key atrule">amqp</span><span class="token punctuation">:</span>
                <span class="token key atrule">$ref</span><span class="token punctuation">:</span> <span class="token string">&quot;#/components/Settings/amqp&quot;</span>
            <span class="token key atrule">produce</span><span class="token punctuation">:</span>
                <span class="token key atrule">exchange</span><span class="token punctuation">:</span>
                    <span class="token key atrule">name</span><span class="token punctuation">:</span> health_messages
            <span class="token key atrule">time_interval</span><span class="token punctuation">:</span> <span class="token number">30000</span>        
            
<span class="token comment">#########################################################################</span>

</code></pre></div><p><strong>Файл налаштувань за замовчуванням</strong> містить налаштування для каналів, обмінників, черг ...</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code>
<span class="token key atrule">msapi</span><span class="token punctuation">:</span> <span class="token string">&quot;1.0.1&quot;</span>

<span class="token key atrule">metadata</span><span class="token punctuation">:</span> 
  
  <span class="token key atrule">id</span><span class="token punctuation">:</span> <span class="token string">&quot;http://localhost:8081/spec/ms_example_defaults.yaml&quot;</span>
  
  <span class="token key atrule">title</span><span class="token punctuation">:</span> <span class="token string">&quot;Default queue and exchange settings&quot;</span>
  
  <span class="token key atrule">description</span><span class="token punctuation">:</span> Default queue and exchange settings
  
 
<span class="token key atrule">components</span><span class="token punctuation">:</span>

<span class="token comment">#########################################################################</span>

    <span class="token key atrule">Exchanges</span><span class="token punctuation">:</span>                          <span class="token comment"># available section</span>
    
        <span class="token key atrule">default</span><span class="token punctuation">:</span>                       <span class="token comment"># an example of exchange definition </span>
            <span class="token key atrule">type</span><span class="token punctuation">:</span> fanout                <span class="token comment"># or &quot;topic&quot; or &quot;direct&quot;  - required type of exchange</span>
            <span class="token key atrule">options</span><span class="token punctuation">:</span>                    <span class="token comment"># optional exchange options</span>
                <span class="token key atrule">durable</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>           <span class="token comment"># (boolean): if true, the exchange will survive broker restarts. Defaults to true.</span>
                <span class="token key atrule">autoDelete</span><span class="token punctuation">:</span> <span class="token boolean important">false</span>       <span class="token comment"># (boolean): if true, the exchange will be destroyed once the number of bindings for which it is the source drop to zero. Defaults to false.</span>

<span class="token comment">#########################################################################</span>

    <span class="token key atrule">Queues</span><span class="token punctuation">:</span>                          <span class="token comment"># available section</span>
    
        <span class="token key atrule">default</span><span class="token punctuation">:</span>                          <span class="token comment"># an example of queue definition</span>
            <span class="token key atrule">exchange</span><span class="token punctuation">:</span> 
                <span class="token key atrule">$ref</span><span class="token punctuation">:</span> <span class="token string">&quot;#/components/Exchanges/default&quot;</span>
            <span class="token key atrule">options</span><span class="token punctuation">:</span>
                <span class="token key atrule">exclusive</span><span class="token punctuation">:</span> <span class="token boolean important">false</span>        <span class="token comment"># if true, scopes the queue to the connection (defaults to false)</span>
                <span class="token key atrule">durable</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>           <span class="token comment"># if true, the queue will survive broker restarts, modulo the effects of exclusive and autoDelete; this defaults to true if not supplied, unlike the others</span>
                <span class="token key atrule">autoDelete</span><span class="token punctuation">:</span> <span class="token boolean important">false</span>       <span class="token comment"># if true, the queue will be deleted when the number of consumers drops to zero (defaults to false)</span>

<span class="token comment">#########################################################################</span>

    <span class="token key atrule">Consumes</span><span class="token punctuation">:</span>                          <span class="token comment"># available section</span>
    
        <span class="token key atrule">default</span><span class="token punctuation">:</span>
            <span class="token key atrule">queue</span><span class="token punctuation">:</span>
                <span class="token key atrule">$ref</span><span class="token punctuation">:</span> <span class="token string">&quot;#/components/Queues/default&quot;</span>
                <span class="token key atrule">message</span><span class="token punctuation">:</span>
                    <span class="token key atrule">options</span><span class="token punctuation">:</span>
                        <span class="token key atrule">noAck</span><span class="token punctuation">:</span> <span class="token boolean important">false</span>        <span class="token comment"># (boolean): if true, the broker won’t expect an acknowledgement of messages delivered to this consumer; i.e., it will dequeue messages as soon as they’ve been sent down the wire. Defaults to false (i.e., you will be expected to acknowledge messages).</span>
                        <span class="token key atrule">exclusive</span><span class="token punctuation">:</span> <span class="token boolean important">false</span>    <span class="token comment"># (boolean): if true, the broker won’t let anyone else consume from this queue; if there already is a consumer, there goes your channel (so usually only useful if you’ve made a ‘private’ queue by letting the server choose its name).</span>

<span class="token comment">#########################################################################</span>

    <span class="token key atrule">Produces</span><span class="token punctuation">:</span>                          <span class="token comment"># available section</span>
    
        <span class="token key atrule">default</span><span class="token punctuation">:</span>
            <span class="token key atrule">exchange</span><span class="token punctuation">:</span>
                <span class="token key atrule">$ref</span><span class="token punctuation">:</span> <span class="token string">&quot;#/components/Exchanges/default&quot;</span>
            <span class="token key atrule">message</span><span class="token punctuation">:</span>
                <span class="token key atrule">options</span><span class="token punctuation">:</span>
                    <span class="token key atrule">persistent</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>    <span class="token comment"># (boolean): If truthy, the message will survive broker restarts provided it’s in a queue that also survives restarts.</span>


</code></pre></div><p><strong>Файл опису черг та типів повідомлень</strong> для робочого процесу</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">msapi</span><span class="token punctuation">:</span> <span class="token string">&quot;1.0.1&quot;</span>

<span class="token key atrule">metadata</span><span class="token punctuation">:</span> 
  
  <span class="token key atrule">id</span><span class="token punctuation">:</span> <span class="token string">&quot;http://localhost:8081/spec/ms_example_components_message_processing.yaml&quot;</span>
  
  <span class="token key atrule">title</span><span class="token punctuation">:</span> <span class="token string">&quot;Shared components for scrappers&quot;</span>
  
  <span class="token key atrule">description</span><span class="token punctuation">:</span> <span class="token punctuation">&gt;</span><span class="token scalar string">
    Defines the components for task messages and for multimedia messages.</span>
    
    Scrapers consume task messages<span class="token punctuation">,</span> scrap sources<span class="token punctuation">,</span> and create multimedia messages.
    
    Normalizer consumes dirty multimedia messages<span class="token punctuation">,</span> handles it<span class="token punctuation">,</span> and creates 
    normalized messages.
    
    All parameters<span class="token punctuation">,</span> exchange definitions and queue definitions will be set to 
    default or overwritten by expanding in the parent spec.
 
<span class="token key atrule">components</span><span class="token punctuation">:</span>

<span class="token comment">#########################################################################</span>

    <span class="token key atrule">Consumes</span><span class="token punctuation">:</span>                          
    
        <span class="token key atrule">TASK_QUEUE</span><span class="token punctuation">:</span>
            <span class="token key atrule">queue</span><span class="token punctuation">:</span>
                <span class="token key atrule">message</span><span class="token punctuation">:</span>
                    <span class="token key atrule">schema</span><span class="token punctuation">:</span>                 
                        <span class="token key atrule">$ref</span><span class="token punctuation">:</span> <span class="token string">&quot;#/components/Schemas/TASK_MESSAGE_SCHEMA&quot;</span>
        
        <span class="token key atrule">MEDIA_MESSAGES</span><span class="token punctuation">:</span>
            <span class="token key atrule">queue</span><span class="token punctuation">:</span>
                <span class="token key atrule">message</span><span class="token punctuation">:</span>
                    <span class="token key atrule">schema</span><span class="token punctuation">:</span>                
                        <span class="token key atrule">$ref</span><span class="token punctuation">:</span> <span class="token string">&quot;#/components/Schemas/MEDIA_MESSAGE_SCHEMA&quot;</span>

<span class="token comment">#########################################################################</span>

    <span class="token key atrule">Produces</span><span class="token punctuation">:</span>                         
    
        <span class="token key atrule">MEDIA_MESSAGES</span><span class="token punctuation">:</span>
            <span class="token key atrule">message</span><span class="token punctuation">:</span>
                <span class="token key atrule">schema</span><span class="token punctuation">:</span>                
                    <span class="token key atrule">$ref</span><span class="token punctuation">:</span> <span class="token string">&quot;#/components/Schemas/MEDIA_MESSAGE_SCHEMA&quot;</span>

<span class="token comment">#########################################################################</span>

    <span class="token key atrule">Schemas</span><span class="token punctuation">:</span>
        
        <span class="token key atrule">TASK_MESSAGE_SCHEMA</span><span class="token punctuation">:</span>
            <span class="token key atrule">type</span><span class="token punctuation">:</span> object
            <span class="token key atrule">required</span><span class="token punctuation">:</span>
                <span class="token punctuation">-</span> id
                <span class="token punctuation">-</span> timestamp
                <span class="token punctuation">-</span> options
            <span class="token key atrule">properties</span><span class="token punctuation">:</span>
                <span class="token key atrule">id</span><span class="token punctuation">:</span> 
                    <span class="token key atrule">type</span><span class="token punctuation">:</span> string
                <span class="token key atrule">timestamp</span><span class="token punctuation">:</span> 
                    <span class="token key atrule">type</span><span class="token punctuation">:</span> string
                <span class="token key atrule">options</span><span class="token punctuation">:</span>
                    <span class="token key atrule">type</span><span class="token punctuation">:</span> object
                
        <span class="token key atrule">MEDIA_MESSAGE_SCHEMA</span><span class="token punctuation">:</span>
                <span class="token key atrule">type</span><span class="token punctuation">:</span> object
                <span class="token key atrule">required</span><span class="token punctuation">:</span>
                    <span class="token punctuation">-</span> id
                    <span class="token punctuation">-</span> timestamp
                    <span class="token punctuation">-</span> scrapper_instance
                    <span class="token punctuation">-</span> data
                <span class="token key atrule">properties</span><span class="token punctuation">:</span>
                    <span class="token key atrule">id</span><span class="token punctuation">:</span> 
                        <span class="token key atrule">type</span><span class="token punctuation">:</span> string
                    <span class="token key atrule">timestamp</span><span class="token punctuation">:</span> 
                        <span class="token key atrule">type</span><span class="token punctuation">:</span> string
                    <span class="token key atrule">scrapper_instance</span><span class="token punctuation">:</span>
                        <span class="token key atrule">type</span><span class="token punctuation">:</span> string
                    <span class="token key atrule">data</span><span class="token punctuation">:</span>
                        <span class="token key atrule">type</span><span class="token punctuation">:</span> object
                        <span class="token key atrule">required</span><span class="token punctuation">:</span>
                            <span class="token punctuation">-</span> text
                        <span class="token key atrule">properties</span><span class="token punctuation">:</span>
                            <span class="token key atrule">meta</span><span class="token punctuation">:</span> 
                                <span class="token key atrule">type</span><span class="token punctuation">:</span> object
                            <span class="token key atrule">text</span><span class="token punctuation">:</span>
                                <span class="token key atrule">type</span><span class="token punctuation">:</span> string
                                
            
        
<span class="token comment">#########################################################################</span>


</code></pre></div><p><strong>Файл опису скрапера</strong>. Опис має властивості, що налаштовуються з декількох джерел, наприклад <code>consumes</code>. Це здійснюється за допомогою властивостей <code>definition</code> та <code>extendedBy</code>. Розширення <code>definition</code> здійснюється на стадії оброблення <code>afterResolve</code>.</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">msapi</span><span class="token punctuation">:</span> <span class="token string">&quot;1.0.1&quot;</span>

<span class="token key atrule">metadata</span><span class="token punctuation">:</span> 
  
    <span class="token key atrule">id</span><span class="token punctuation">:</span> <span class="token string">&quot;http://localhost:8081/spec/ms_example_scraper_service.yaml&quot;</span>
  
    <span class="token key atrule">title</span><span class="token punctuation">:</span> <span class="token string">&quot;Scraper Service type definition&quot;</span>
  
    <span class="token key atrule">description</span><span class="token punctuation">:</span> <span class="token punctuation">&gt;</span><span class="token scalar string">
        Defines the type of scraper service.
        Scrapers consume task messages, scrap sources, and create multimedia messages.
        Normalizer consumes dirty multimedia messages, handles it, and creates 
        normalized messages.Normalizer consumes dirty multimedia messages, handles it, and creates 
        normalized messages.</span>
    
    <span class="token key atrule">repo</span><span class="token punctuation">:</span> <span class="token string">&quot;@molfar/scraper&quot;</span>
            

<span class="token key atrule">service</span><span class="token punctuation">:</span>
    
    <span class="token key atrule">config</span><span class="token punctuation">:</span>
        
        <span class="token key atrule">amqp</span><span class="token punctuation">:</span>
            <span class="token key atrule">$ref</span><span class="token punctuation">:</span> <span class="token string">&quot;./ms_example_global_settings.yaml/#/components/Settings/amqp&quot;</span>
        
        <span class="token key atrule">consume</span><span class="token punctuation">:</span>
            <span class="token key atrule">amqp</span><span class="token punctuation">:</span>
                <span class="token key atrule">$ref</span><span class="token punctuation">:</span> <span class="token string">&quot;#/service/config/amqp&quot;</span>
            <span class="token key atrule">queue</span><span class="token punctuation">:</span>
                <span class="token key atrule">exchange</span><span class="token punctuation">:</span>
                    <span class="token key atrule">name</span><span class="token punctuation">:</span> scrapper_task_messages
        <span class="token key atrule">produce</span><span class="token punctuation">:</span>
            <span class="token key atrule">amqp</span><span class="token punctuation">:</span>
                <span class="token key atrule">$ref</span><span class="token punctuation">:</span> <span class="token string">&quot;#/service/config/amqp&quot;</span>
            <span class="token key atrule">exchange</span><span class="token punctuation">:</span>
                <span class="token key atrule">name</span><span class="token punctuation">:</span>
                    <span class="token key atrule">schema</span><span class="token punctuation">:</span>
                        <span class="token key atrule">type</span><span class="token punctuation">:</span> string
                        
        <span class="token key atrule">health_check</span><span class="token punctuation">:</span>
            <span class="token key atrule">$ref</span><span class="token punctuation">:</span> <span class="token string">&quot;./ms_example_global_settings.yaml/#/components/Settings/health&quot;</span>    
                        
    <span class="token key atrule">consumes</span><span class="token punctuation">:</span>
        <span class="token punctuation">-</span> 
            <span class="token key atrule">definition</span><span class="token punctuation">:</span>
                <span class="token key atrule">$ref</span><span class="token punctuation">:</span> <span class="token string">&quot;./ms_example_defaults.yaml/#/components/Consumes/default&quot;</span>
            <span class="token key atrule">extendedBy</span><span class="token punctuation">:</span>
                <span class="token punctuation">-</span> 
                    <span class="token key atrule">$ref</span><span class="token punctuation">:</span> <span class="token string">&quot;./ms_example_components_message_processing.yaml/#/components/Consumes/TASK_QUEUE&quot;</span>
                <span class="token punctuation">-</span> 
                    <span class="token key atrule">$ref</span><span class="token punctuation">:</span> <span class="token string">&quot;#/service/config/consume&quot;</span>
    
    <span class="token key atrule">produce</span><span class="token punctuation">:</span>
        <span class="token key atrule">definition</span><span class="token punctuation">:</span>
            <span class="token key atrule">$ref</span><span class="token punctuation">:</span> <span class="token string">&quot;./ms_example_defaults.yaml/#/components/Produces/default&quot;</span>
        <span class="token key atrule">extendedBy</span><span class="token punctuation">:</span>
            <span class="token punctuation">-</span> 
                <span class="token key atrule">$ref</span><span class="token punctuation">:</span> <span class="token string">&quot;./ms_example_components_message_processing.yaml/#/components/Produces/MEDIA_MESSAGES&quot;</span>
            <span class="token punctuation">-</span> 
                <span class="token key atrule">$ref</span><span class="token punctuation">:</span> <span class="token string">&quot;#/service/config/produce&quot;</span>
        


</code></pre></div><p><strong>Файл опису нормарайзера</strong></p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">msapi</span><span class="token punctuation">:</span> <span class="token string">&quot;1.0.1&quot;</span>

<span class="token key atrule">metadata</span><span class="token punctuation">:</span> 
  
    <span class="token key atrule">id</span><span class="token punctuation">:</span> <span class="token string">&quot;http://localhost:8081/spec/ms_example_normalizer_service.yaml&quot;</span>
  
    <span class="token key atrule">title</span><span class="token punctuation">:</span> <span class="token string">&quot;Normalizer Service type definition&quot;</span>
  
    <span class="token key atrule">description</span><span class="token punctuation">:</span> <span class="token punctuation">&gt;</span><span class="token scalar string">
        Defines the type of normalizer service.
        Normalizer consumes dirty multimedia messages, handles it, and creates 
        normalized messages.</span>
    
    <span class="token key atrule">repo</span><span class="token punctuation">:</span> <span class="token string">&quot;@molfar/normalizer&quot;</span>
            

<span class="token key atrule">service</span><span class="token punctuation">:</span>
    
    <span class="token key atrule">config</span><span class="token punctuation">:</span>
        
        <span class="token key atrule">amqp</span><span class="token punctuation">:</span>
            <span class="token key atrule">$ref</span><span class="token punctuation">:</span> <span class="token string">&quot;./ms_example_global_settings.yaml/#/components/Settings/amqp&quot;</span>    
        
        <span class="token key atrule">consume</span><span class="token punctuation">:</span>
            <span class="token key atrule">amqp</span><span class="token punctuation">:</span>
                <span class="token key atrule">$ref</span><span class="token punctuation">:</span> <span class="token string">&quot;#/service/config/amqp&quot;</span>
            <span class="token key atrule">queue</span><span class="token punctuation">:</span>
                <span class="token key atrule">exchange</span><span class="token punctuation">:</span>
                    <span class="token key atrule">name</span><span class="token punctuation">:</span>
                        <span class="token key atrule">schema</span><span class="token punctuation">:</span>
                            <span class="token key atrule">type</span><span class="token punctuation">:</span> string
        <span class="token key atrule">produce</span><span class="token punctuation">:</span>
            <span class="token key atrule">amqp</span><span class="token punctuation">:</span>
                <span class="token key atrule">$ref</span><span class="token punctuation">:</span> <span class="token string">&quot;#/service/config/amqp&quot;</span>
            <span class="token key atrule">exchange</span><span class="token punctuation">:</span>
                <span class="token key atrule">name</span><span class="token punctuation">:</span>
                    <span class="token key atrule">schema</span><span class="token punctuation">:</span>
                        <span class="token key atrule">type</span><span class="token punctuation">:</span> string
                        
        <span class="token key atrule">health_check</span><span class="token punctuation">:</span>
            <span class="token key atrule">$ref</span><span class="token punctuation">:</span> <span class="token string">&quot;./ms_example_global_settings.yaml/#/components/Settings/health&quot;</span>    
                        
                        
    <span class="token key atrule">consumes</span><span class="token punctuation">:</span>
        <span class="token punctuation">-</span> 
            <span class="token key atrule">definition</span><span class="token punctuation">:</span>
                <span class="token key atrule">$ref</span><span class="token punctuation">:</span> <span class="token string">&quot;./ms_example_defaults.yaml/#/components/Consumes/default&quot;</span>
            
            <span class="token key atrule">extendedBy</span><span class="token punctuation">:</span>
                <span class="token punctuation">-</span>    
                    <span class="token key atrule">$ref</span><span class="token punctuation">:</span> <span class="token string">&quot;./ms_example_components_message_processing.yaml/#/components/Consumes/MEDIA_MESSAGES&quot;</span>
                <span class="token punctuation">-</span>
                    <span class="token key atrule">$ref</span><span class="token punctuation">:</span> <span class="token string">&quot;#/service/config/consume&quot;</span>
    
    <span class="token key atrule">produce</span><span class="token punctuation">:</span>
        <span class="token key atrule">definition</span><span class="token punctuation">:</span>
            <span class="token key atrule">$ref</span><span class="token punctuation">:</span> <span class="token string">&quot;./ms_example_defaults.yaml/#/components/Produces/default&quot;</span>
        <span class="token key atrule">extendedBy</span><span class="token punctuation">:</span>
            <span class="token punctuation">-</span> 
                <span class="token key atrule">$ref</span><span class="token punctuation">:</span> <span class="token string">&quot;./ms_example_components_message_processing.yaml/#/components/Produces/MEDIA_MESSAGES&quot;</span>
            <span class="token punctuation">-</span> 
                <span class="token key atrule">$ref</span><span class="token punctuation">:</span> <span class="token string">&quot;#/service/config/produce&quot;</span>
        


</code></pre></div><p><strong>Файл опису робочого процесу</strong>. Робочий процес описано як послідовність зконфігурованих екземплярів сервісів. Накладання <code>configuredBy</code> на <code>config</code> здійснюється на стадії <code>afterBundle</code>.</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">msapi</span><span class="token punctuation">:</span> <span class="token string">&quot;1.0.1&quot;</span>

<span class="token key atrule">metadata</span><span class="token punctuation">:</span> 
  
    <span class="token key atrule">id</span><span class="token punctuation">:</span> <span class="token string">&quot;http://localhost:8081/spec/ms_example_workflow.yaml&quot;</span>
  
    <span class="token key atrule">title</span><span class="token punctuation">:</span> <span class="token string">&quot;Define a workflow for handling multimedia messages&quot;</span>
  
    <span class="token key atrule">description</span><span class="token punctuation">:</span> <span class="token punctuation">&gt;</span><span class="token scalar string">
        Defines a chain of two services
            </span>

<span class="token key atrule">workflow</span><span class="token punctuation">:</span>
    
    <span class="token punctuation">-</span> <span class="token key atrule">instance</span><span class="token punctuation">:</span>
        <span class="token key atrule">of</span><span class="token punctuation">:</span>
            <span class="token key atrule">$ref</span><span class="token punctuation">:</span> <span class="token string">&quot;./ms_example_scraper_service.yaml&quot;</span>
        
        <span class="token key atrule">name</span><span class="token punctuation">:</span> SCRAPPER
        
        <span class="token key atrule">configuredBy</span><span class="token punctuation">:</span>
            
            <span class="token key atrule">produce</span><span class="token punctuation">:</span>
                <span class="token key atrule">exchange</span><span class="token punctuation">:</span>
                    <span class="token key atrule">name</span><span class="token punctuation">:</span> dirty_messages
    
    <span class="token punctuation">-</span> <span class="token key atrule">instance</span><span class="token punctuation">:</span>
        <span class="token key atrule">of</span><span class="token punctuation">:</span>
            <span class="token key atrule">$ref</span><span class="token punctuation">:</span> <span class="token string">&quot;./ms_example_normalizer_service.yaml&quot;</span>
        
        <span class="token key atrule">configuredBy</span><span class="token punctuation">:</span>
            
            <span class="token key atrule">consume</span><span class="token punctuation">:</span>
                <span class="token key atrule">queue</span><span class="token punctuation">:</span>
                    <span class="token key atrule">exchange</span><span class="token punctuation">:</span>
                        <span class="token key atrule">name</span><span class="token punctuation">:</span> dirty_messages
            
            <span class="token key atrule">produce</span><span class="token punctuation">:</span>
                <span class="token key atrule">exchange</span><span class="token punctuation">:</span>
                    <span class="token key atrule">name</span><span class="token punctuation">:</span> normalized_messages            
                        
                


</code></pre></div><p>Побудувати результат роботи парсера для прикладу можна за допомогою команди</p> <div class="language-sh extra-class"><pre class="language-sh"><code>
<span class="token function">npm</span> run example

</code></pre></div><p><strong>Використання парсера</strong> для побудови api:</p> <div class="language-js extra-class"><pre class="language-js"><code>
<span class="token keyword">import</span> MsapiParser <span class="token keyword">from</span> <span class="token string">&quot;../lib&quot;</span>
<span class="token keyword">import</span> fs <span class="token keyword">from</span> <span class="token string">&quot;fs&quot;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> assign<span class="token punctuation">,</span> set<span class="token punctuation">,</span> isArray <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;lodash&quot;</span>
<span class="token keyword">import</span> <span class="token constant">YAML</span> <span class="token keyword">from</span> <span class="token string">&quot;js-yaml&quot;</span>



<span class="token keyword">const</span> <span class="token function-variable function">applyConfiguredByToConfig</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token parameter">api</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>

    <span class="token keyword">let</span> instances <span class="token operator">=</span> MsapiParser<span class="token punctuation">.</span>util<span class="token punctuation">.</span><span class="token function">deepFilter</span><span class="token punctuation">(</span>api<span class="token punctuation">,</span> <span class="token parameter">o</span> <span class="token operator">=&gt;</span> o<span class="token punctuation">.</span>instance<span class="token punctuation">)</span>
    instances<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span> <span class="token parameter">o</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> res <span class="token operator">=</span> <span class="token function">assign</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> o<span class="token punctuation">.</span>instance<span class="token punctuation">.</span>instance<span class="token punctuation">)</span>
        res<span class="token punctuation">.</span>configuredBy <span class="token operator">=</span> res<span class="token punctuation">.</span>configuredBy <span class="token operator">||</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
        res<span class="token punctuation">.</span>of<span class="token punctuation">.</span>service<span class="token punctuation">.</span>config <span class="token operator">=</span> MsapiParser<span class="token punctuation">.</span>util<span class="token punctuation">.</span><span class="token function">deepExtend</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>of<span class="token punctuation">.</span>service<span class="token punctuation">.</span>config<span class="token punctuation">,</span> res<span class="token punctuation">.</span>configuredBy<span class="token punctuation">)</span>
        <span class="token function">set</span><span class="token punctuation">(</span>o<span class="token punctuation">.</span>instance<span class="token punctuation">,</span> <span class="token string">&quot;instance.of.service.config&quot;</span><span class="token punctuation">,</span> <span class="token function">assign</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>res<span class="token punctuation">.</span>of<span class="token punctuation">.</span>service<span class="token punctuation">.</span>config<span class="token punctuation">)</span><span class="token punctuation">)</span> 
    <span class="token punctuation">}</span><span class="token punctuation">)</span>

    <span class="token keyword">return</span> api

<span class="token punctuation">}</span>

<span class="token keyword">const</span> <span class="token function-variable function">applyExtendedBy</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token parameter">api</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>

    MsapiParser<span class="token punctuation">.</span>util<span class="token punctuation">.</span><span class="token function">deepFilter</span><span class="token punctuation">(</span>api<span class="token punctuation">,</span> <span class="token parameter">o</span> <span class="token operator">=&gt;</span> o<span class="token punctuation">.</span>definition<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span> <span class="token parameter">o</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> res <span class="token operator">=</span> <span class="token function">assign</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>o<span class="token punctuation">.</span>instance<span class="token punctuation">.</span>definition<span class="token punctuation">)</span>
        o<span class="token punctuation">.</span>instance<span class="token punctuation">.</span>extendedBy<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span> <span class="token parameter">e</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            res <span class="token operator">=</span> <span class="token function">assign</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> MsapiParser<span class="token punctuation">.</span>util<span class="token punctuation">.</span><span class="token function">deepExtend</span><span class="token punctuation">(</span>res<span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token function">set</span><span class="token punctuation">(</span>api<span class="token punctuation">,</span> o<span class="token punctuation">.</span>path<span class="token punctuation">,</span> <span class="token function">assign</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>res<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>

    <span class="token keyword">return</span> api

<span class="token punctuation">}</span>

<span class="token keyword">const</span> <span class="token function-variable function">removeConfiguredBy</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token parameter">api</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    MsapiParser<span class="token punctuation">.</span>util<span class="token punctuation">.</span><span class="token function">deepFilter</span><span class="token punctuation">(</span>api<span class="token punctuation">,</span> <span class="token parameter">o</span> <span class="token operator">=&gt;</span> o<span class="token punctuation">.</span>configuredBy<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span> <span class="token parameter">o</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">delete</span> o<span class="token punctuation">.</span>instance<span class="token punctuation">.</span>configuredBy
    <span class="token punctuation">}</span><span class="token punctuation">)</span>

    <span class="token keyword">return</span> api
<span class="token punctuation">}</span>


<span class="token punctuation">(</span>   
    
    <span class="token keyword">async</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">let</span> spec <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span><span class="token string">&quot;./MSAPI_example/ms_example_workflow.yaml&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            
            <span class="token keyword">let</span> api <span class="token operator">=</span> <span class="token keyword">await</span> MsapiParser<span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span>
                <span class="token string">&quot;./MSAPI_example/ms_example_workflow.yaml&quot;</span><span class="token punctuation">,</span>
                <span class="token punctuation">{</span>
                    afterBundle<span class="token operator">:</span> applyConfiguredByToConfig<span class="token punctuation">,</span>
                    afterResolve<span class="token operator">:</span> <span class="token punctuation">[</span> applyExtendedBy<span class="token punctuation">,</span> removeConfiguredBy <span class="token punctuation">]</span>   
                <span class="token punctuation">}</span>
            <span class="token punctuation">)</span>

            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>api<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token string">&quot; &quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
            err<span class="token punctuation">.</span><span class="token function">toJSON</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>details<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span> <span class="token parameter">d</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>d<span class="token punctuation">.</span>message<span class="token punctuation">,</span> d<span class="token punctuation">.</span>path<span class="token punctuation">,</span> d<span class="token punctuation">.</span>params<span class="token punctuation">,</span> MsapiParser<span class="token punctuation">.</span>util<span class="token punctuation">.</span><span class="token function">getLineNumberForPath</span><span class="token punctuation">(</span>spec<span class="token punctuation">,</span>d<span class="token punctuation">.</span>path<span class="token punctuation">)</span><span class="token punctuation">)</span>
                d<span class="token punctuation">.</span>inner<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span> <span class="token parameter">i</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>i<span class="token punctuation">.</span>message<span class="token punctuation">,</span> i<span class="token punctuation">.</span>path<span class="token punctuation">,</span> i<span class="token punctuation">.</span>params<span class="token punctuation">,</span> MsapiParser<span class="token punctuation">.</span>util<span class="token punctuation">.</span><span class="token function">getLineNumberForPath</span><span class="token punctuation">(</span>spec<span class="token punctuation">,</span>i<span class="token punctuation">.</span>path<span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">}</span><span class="token punctuation">)</span>  
             <span class="token punctuation">}</span><span class="token punctuation">)</span>

        <span class="token punctuation">}</span>   
    <span class="token punctuation">}</span>

<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span>


</code></pre></div><p><code>MsapiParser.build</code> приймає шлях до файлу або URL, а також налаштування - обробники для стадій <code>afterBundle</code> та <code>afterResolve</code>.</p> <p>Після стадії <code>afterBundle</code> всі зовнішні посилання замінені на значення (внутрішні посилання - без змін). На цій стадії ми накладаємо <code>configuredBy</code> на <code>config</code> (<code>applyConfiguredByToConfig</code>).</p> <p>Після стадії <code>afterResolve</code> вже всі посилання замінені на значення. На цій стадії ми здійснюємо розширення <code>definition</code> за допомогою <code>extendedBy</code> (<code>applyExtendedBy</code>) та видаляємо <code>configuredBy</code> (<code>removeConfiguredBy</code>).</p> <p>Отримуємо повністю визначений об'єкт для налаштування робочого процесу:</p> <div class="language-json extra-class"><pre class="language-json"><code>
<span class="token punctuation">{</span>
 <span class="token property">&quot;msapi&quot;</span><span class="token operator">:</span> <span class="token string">&quot;1.0.1&quot;</span><span class="token punctuation">,</span>
 <span class="token property">&quot;metadata&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
  <span class="token property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;http://localhost:8081/spec/ms_example_workflow.yaml&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;title&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Define a workflow for handling multimedia messages&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;description&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Defines a chain of two services\n    \n&quot;</span>
 <span class="token punctuation">}</span><span class="token punctuation">,</span>
 <span class="token property">&quot;workflow&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
  <span class="token punctuation">{</span>
   <span class="token property">&quot;instance&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;of&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
     <span class="token property">&quot;msapi&quot;</span><span class="token operator">:</span> <span class="token string">&quot;1.0.1&quot;</span><span class="token punctuation">,</span>
     <span class="token property">&quot;metadata&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;http://localhost:8081/spec/ms_example_scraper_service.yaml&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;title&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Scraper Service type definition&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;description&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Defines the type of scraper service. Scrapers consume task messages, scrap sources, and create multimedia messages. Normalizer consumes dirty multimedia messages, handles it, and creates  normalized messages.Normalizer consumes dirty multimedia messages, handles it, and creates  normalized messages.\n&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;repo&quot;</span><span class="token operator">:</span> <span class="token string">&quot;@molfar/scraper&quot;</span>
     <span class="token punctuation">}</span><span class="token punctuation">,</span>
     <span class="token property">&quot;service&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;config&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
       <span class="token property">&quot;amqp&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;url&quot;</span><span class="token operator">:</span> <span class="token string">&quot;amqps://xoilebqg:Nx46t4t9cxQ2M0rF2rIyZPS_xbAhmJIG@hornet.rmq.cloudamqp.com/xoilebqg&quot;</span>
       <span class="token punctuation">}</span><span class="token punctuation">,</span>
       <span class="token property">&quot;consume&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;amqp&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
         <span class="token property">&quot;url&quot;</span><span class="token operator">:</span> <span class="token string">&quot;amqps://xoilebqg:Nx46t4t9cxQ2M0rF2rIyZPS_xbAhmJIG@hornet.rmq.cloudamqp.com/xoilebqg&quot;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">&quot;queue&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
         <span class="token property">&quot;exchange&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;scrapper_task_messages&quot;</span>
         <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
       <span class="token punctuation">}</span><span class="token punctuation">,</span>
       <span class="token property">&quot;produce&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;amqp&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
         <span class="token property">&quot;url&quot;</span><span class="token operator">:</span> <span class="token string">&quot;amqps://xoilebqg:Nx46t4t9cxQ2M0rF2rIyZPS_xbAhmJIG@hornet.rmq.cloudamqp.com/xoilebqg&quot;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">&quot;exchange&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
         <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;dirty_messages&quot;</span>
        <span class="token punctuation">}</span>
       <span class="token punctuation">}</span><span class="token punctuation">,</span>
       <span class="token property">&quot;health_check&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;amqp&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
         <span class="token property">&quot;url&quot;</span><span class="token operator">:</span> <span class="token string">&quot;amqps://xoilebqg:Nx46t4t9cxQ2M0rF2rIyZPS_xbAhmJIG@hornet.rmq.cloudamqp.com/xoilebqg&quot;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">&quot;produce&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
         <span class="token property">&quot;exchange&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;health_messages&quot;</span>
         <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">&quot;time_interval&quot;</span><span class="token operator">:</span> <span class="token number">30000</span>
       <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token property">&quot;consumes&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
       <span class="token punctuation">{</span>
        <span class="token property">&quot;queue&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
         <span class="token property">&quot;message&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">&quot;options&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
           <span class="token property">&quot;noAck&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
           <span class="token property">&quot;exclusive&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token property">&quot;schema&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
           <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;object&quot;</span><span class="token punctuation">,</span>
           <span class="token property">&quot;required&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token string">&quot;id&quot;</span><span class="token punctuation">,</span>
            <span class="token string">&quot;timestamp&quot;</span><span class="token punctuation">,</span>
            <span class="token string">&quot;scrapper_instance&quot;</span><span class="token punctuation">,</span>
            <span class="token string">&quot;data&quot;</span>
           <span class="token punctuation">]</span><span class="token punctuation">,</span>
           <span class="token property">&quot;properties&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
             <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;string&quot;</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token property">&quot;timestamp&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
             <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;string&quot;</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token property">&quot;options&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
             <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;object&quot;</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token property">&quot;scrapper_instance&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
             <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;string&quot;</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token property">&quot;data&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
             <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;object&quot;</span><span class="token punctuation">,</span>
             <span class="token property">&quot;required&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
              <span class="token string">&quot;text&quot;</span>
             <span class="token punctuation">]</span><span class="token punctuation">,</span>
             <span class="token property">&quot;properties&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
              <span class="token property">&quot;meta&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
               <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;object&quot;</span>
              <span class="token punctuation">}</span><span class="token punctuation">,</span>
              <span class="token property">&quot;text&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
               <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;string&quot;</span>
              <span class="token punctuation">}</span>
             <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
           <span class="token punctuation">}</span>
          <span class="token punctuation">}</span>
         <span class="token punctuation">}</span><span class="token punctuation">,</span>
         <span class="token property">&quot;exchange&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;fanout&quot;</span><span class="token punctuation">,</span>
          <span class="token property">&quot;options&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
           <span class="token property">&quot;durable&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
           <span class="token property">&quot;autoDelete&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;normalized_messages&quot;</span>
         <span class="token punctuation">}</span><span class="token punctuation">,</span>
         <span class="token property">&quot;options&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">&quot;exclusive&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
          <span class="token property">&quot;durable&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
          <span class="token property">&quot;autoDelete&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span>
         <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">&quot;amqp&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
         <span class="token property">&quot;url&quot;</span><span class="token operator">:</span> <span class="token string">&quot;amqps://xoilebqg:Nx46t4t9cxQ2M0rF2rIyZPS_xbAhmJIG@hornet.rmq.cloudamqp.com/xoilebqg&quot;</span>
        <span class="token punctuation">}</span>
       <span class="token punctuation">}</span>
      <span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token property">&quot;produce&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
       <span class="token property">&quot;exchange&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;fanout&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;options&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
         <span class="token property">&quot;durable&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
         <span class="token property">&quot;autoDelete&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;normalized_messages&quot;</span>
       <span class="token punctuation">}</span><span class="token punctuation">,</span>
       <span class="token property">&quot;message&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;options&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
         <span class="token property">&quot;persistent&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">&quot;schema&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
         <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;object&quot;</span><span class="token punctuation">,</span>
         <span class="token property">&quot;required&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
          <span class="token string">&quot;id&quot;</span><span class="token punctuation">,</span>
          <span class="token string">&quot;timestamp&quot;</span><span class="token punctuation">,</span>
          <span class="token string">&quot;scrapper_instance&quot;</span><span class="token punctuation">,</span>
          <span class="token string">&quot;data&quot;</span>
         <span class="token punctuation">]</span><span class="token punctuation">,</span>
         <span class="token property">&quot;properties&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
           <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;string&quot;</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token property">&quot;timestamp&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
           <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;string&quot;</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token property">&quot;scrapper_instance&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
           <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;string&quot;</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token property">&quot;data&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
           <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;object&quot;</span><span class="token punctuation">,</span>
           <span class="token property">&quot;required&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token string">&quot;text&quot;</span>
           <span class="token punctuation">]</span><span class="token punctuation">,</span>
           <span class="token property">&quot;properties&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;meta&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
             <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;object&quot;</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token property">&quot;text&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
             <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;string&quot;</span>
            <span class="token punctuation">}</span>
           <span class="token punctuation">}</span>
          <span class="token punctuation">}</span>
         <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
       <span class="token punctuation">}</span><span class="token punctuation">,</span>
       <span class="token property">&quot;amqp&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;url&quot;</span><span class="token operator">:</span> <span class="token string">&quot;amqps://xoilebqg:Nx46t4t9cxQ2M0rF2rIyZPS_xbAhmJIG@hornet.rmq.cloudamqp.com/xoilebqg&quot;</span>
       <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
     <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;SCRAPPER&quot;</span>
   <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
   <span class="token property">&quot;instance&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;of&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
     <span class="token property">&quot;msapi&quot;</span><span class="token operator">:</span> <span class="token string">&quot;1.0.1&quot;</span><span class="token punctuation">,</span>
     <span class="token property">&quot;metadata&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;http://localhost:8081/spec/ms_example_normalizer_service.yaml&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;title&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Normalizer Service type definition&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;description&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Defines the type of normalizer service. Normalizer consumes dirty multimedia messages, handles it, and creates  normalized messages.\n&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;repo&quot;</span><span class="token operator">:</span> <span class="token string">&quot;@molfar/normalizer&quot;</span>
     <span class="token punctuation">}</span><span class="token punctuation">,</span>
     <span class="token property">&quot;service&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;config&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
       <span class="token property">&quot;amqp&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;url&quot;</span><span class="token operator">:</span> <span class="token string">&quot;amqps://xoilebqg:Nx46t4t9cxQ2M0rF2rIyZPS_xbAhmJIG@hornet.rmq.cloudamqp.com/xoilebqg&quot;</span>
       <span class="token punctuation">}</span><span class="token punctuation">,</span>
       <span class="token property">&quot;consume&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;amqp&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
         <span class="token property">&quot;url&quot;</span><span class="token operator">:</span> <span class="token string">&quot;amqps://xoilebqg:Nx46t4t9cxQ2M0rF2rIyZPS_xbAhmJIG@hornet.rmq.cloudamqp.com/xoilebqg&quot;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">&quot;queue&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
         <span class="token property">&quot;exchange&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;dirty_messages&quot;</span>
         <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
       <span class="token punctuation">}</span><span class="token punctuation">,</span>
       <span class="token property">&quot;produce&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;amqp&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
         <span class="token property">&quot;url&quot;</span><span class="token operator">:</span> <span class="token string">&quot;amqps://xoilebqg:Nx46t4t9cxQ2M0rF2rIyZPS_xbAhmJIG@hornet.rmq.cloudamqp.com/xoilebqg&quot;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">&quot;exchange&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
         <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;normalized_messages&quot;</span>
        <span class="token punctuation">}</span>
       <span class="token punctuation">}</span><span class="token punctuation">,</span>
       <span class="token property">&quot;health_check&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;amqp&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
         <span class="token property">&quot;url&quot;</span><span class="token operator">:</span> <span class="token string">&quot;amqps://xoilebqg:Nx46t4t9cxQ2M0rF2rIyZPS_xbAhmJIG@hornet.rmq.cloudamqp.com/xoilebqg&quot;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">&quot;produce&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
         <span class="token property">&quot;exchange&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;health_messages&quot;</span>
         <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">&quot;time_interval&quot;</span><span class="token operator">:</span> <span class="token number">30000</span>
       <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token property">&quot;consumes&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
       <span class="token punctuation">{</span>
        <span class="token property">&quot;queue&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
         <span class="token property">&quot;message&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">&quot;options&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
           <span class="token property">&quot;noAck&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
           <span class="token property">&quot;exclusive&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token property">&quot;schema&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
           <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;object&quot;</span><span class="token punctuation">,</span>
           <span class="token property">&quot;required&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token string">&quot;id&quot;</span><span class="token punctuation">,</span>
            <span class="token string">&quot;timestamp&quot;</span><span class="token punctuation">,</span>
            <span class="token string">&quot;scrapper_instance&quot;</span><span class="token punctuation">,</span>
            <span class="token string">&quot;data&quot;</span>
           <span class="token punctuation">]</span><span class="token punctuation">,</span>
           <span class="token property">&quot;properties&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
             <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;string&quot;</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token property">&quot;timestamp&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
             <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;string&quot;</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token property">&quot;options&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
             <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;object&quot;</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token property">&quot;scrapper_instance&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
             <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;string&quot;</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token property">&quot;data&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
             <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;object&quot;</span><span class="token punctuation">,</span>
             <span class="token property">&quot;required&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
              <span class="token string">&quot;text&quot;</span>
             <span class="token punctuation">]</span><span class="token punctuation">,</span>
             <span class="token property">&quot;properties&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
              <span class="token property">&quot;meta&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
               <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;object&quot;</span>
              <span class="token punctuation">}</span><span class="token punctuation">,</span>
              <span class="token property">&quot;text&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
               <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;string&quot;</span>
              <span class="token punctuation">}</span>
             <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
           <span class="token punctuation">}</span>
          <span class="token punctuation">}</span>
         <span class="token punctuation">}</span><span class="token punctuation">,</span>
         <span class="token property">&quot;exchange&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;fanout&quot;</span><span class="token punctuation">,</span>
          <span class="token property">&quot;options&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
           <span class="token property">&quot;durable&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
           <span class="token property">&quot;autoDelete&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;normalized_messages&quot;</span>
         <span class="token punctuation">}</span><span class="token punctuation">,</span>
         <span class="token property">&quot;options&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">&quot;exclusive&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
          <span class="token property">&quot;durable&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
          <span class="token property">&quot;autoDelete&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span>
         <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">&quot;amqp&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
         <span class="token property">&quot;url&quot;</span><span class="token operator">:</span> <span class="token string">&quot;amqps://xoilebqg:Nx46t4t9cxQ2M0rF2rIyZPS_xbAhmJIG@hornet.rmq.cloudamqp.com/xoilebqg&quot;</span>
        <span class="token punctuation">}</span>
       <span class="token punctuation">}</span>
      <span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token property">&quot;produce&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
       <span class="token property">&quot;exchange&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;fanout&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;options&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
         <span class="token property">&quot;durable&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
         <span class="token property">&quot;autoDelete&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;normalized_messages&quot;</span>
       <span class="token punctuation">}</span><span class="token punctuation">,</span>
       <span class="token property">&quot;message&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;options&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
         <span class="token property">&quot;persistent&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">&quot;schema&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
         <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;object&quot;</span><span class="token punctuation">,</span>
         <span class="token property">&quot;required&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
          <span class="token string">&quot;id&quot;</span><span class="token punctuation">,</span>
          <span class="token string">&quot;timestamp&quot;</span><span class="token punctuation">,</span>
          <span class="token string">&quot;scrapper_instance&quot;</span><span class="token punctuation">,</span>
          <span class="token string">&quot;data&quot;</span>
         <span class="token punctuation">]</span><span class="token punctuation">,</span>
         <span class="token property">&quot;properties&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
           <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;string&quot;</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token property">&quot;timestamp&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
           <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;string&quot;</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token property">&quot;scrapper_instance&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
           <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;string&quot;</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token property">&quot;data&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
           <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;object&quot;</span><span class="token punctuation">,</span>
           <span class="token property">&quot;required&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token string">&quot;text&quot;</span>
           <span class="token punctuation">]</span><span class="token punctuation">,</span>
           <span class="token property">&quot;properties&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;meta&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
             <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;object&quot;</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token property">&quot;text&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
             <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;string&quot;</span>
            <span class="token punctuation">}</span>
           <span class="token punctuation">}</span>
          <span class="token punctuation">}</span>
         <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
       <span class="token punctuation">}</span><span class="token punctuation">,</span>
       <span class="token property">&quot;amqp&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;url&quot;</span><span class="token operator">:</span> <span class="token string">&quot;amqps://xoilebqg:Nx46t4t9cxQ2M0rF2rIyZPS_xbAhmJIG@hornet.rmq.cloudamqp.com/xoilebqg&quot;</span>
       <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
     <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
   <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
 <span class="token punctuation">]</span>
<span class="token punctuation">}</span>

</code></pre></div></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Останнє оновлення:</span> <span class="time">10/7/2021, 6:24:24 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/msapi-parser/requirements/" class="prev">
        Вимоги
      </a></span> <span class="next"><a href="/msapi-parser/api/">
        API
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/msapi-parser/assets/js/app.bded45cf.js" defer></script><script src="/msapi-parser/assets/js/2.79cb4c26.js" defer></script><script src="/msapi-parser/assets/js/21.261008f1.js" defer></script>
  </body>
</html>
